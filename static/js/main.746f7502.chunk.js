(this["webpackJsonpmultiplayer-trivia"]=this["webpackJsonpmultiplayer-trivia"]||[]).push([[0],{45:function(e,s,t){},46:function(e,s,t){},47:function(e,s,t){},52:function(e,s,t){},53:function(e,s,t){},61:function(e,s,t){"use strict";t.r(s);var a=t(1),i=t.n(a),n=t(22),r=t.n(n),o=(t(45),t(15)),c=t(11),l=t(17),d=t(16),u=t.p+"static/media/logo.6ce24c58.svg",h=(t(46),t(32)),p=t(9),j=(t(47),t(82)),m=t(20),b=(t(48),t(52),t(53),t(83)),v=t(80),g=t(2);function f(e){return Object(g.jsxs)("div",{className:"counter",children:[Object(g.jsx)("div",{hidden:!e.isHost,children:Object(g.jsx)("button",{className:"counter-action decrement",onClick:function(){e.onChange(-1)},children:" - "})}),Object(g.jsxs)("div",{className:"counter-score",children:[" ",e.score," "]}),Object(g.jsx)("div",{hidden:!e.isHost,children:Object(g.jsx)("button",{className:"counter-action increment",hidden:!e.isHost,onClick:function(){e.onChange(1)},children:" + "})})]})}var y=function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(){return Object(o.a)(this,t),s.apply(this,arguments)}return Object(c.a)(t,[{key:"render",value:function(){var e=["primary","default","default"],s=["medium","small","small"];return Object(g.jsxs)("div",{className:"player",children:[Object(g.jsxs)("div",{className:"player-container",children:[Object(g.jsx)("div",{hidden:!this.props.isLeader,className:"leader-icon",children:"\ud83d\udc51"}),Object(g.jsxs)("div",{className:"player-name",children:[Object(g.jsx)("img",{src:this.props.photoURL,className:"player-photo"}),this.props.name,Object(g.jsx)(v.a,{className:"chat-icon"})]}),Object(g.jsx)("div",{className:"message-chips",children:this.props.messages?this.props.messages.messages.map((function(t,a){return Object(g.jsx)(b.a,{label:t,size:s[a],color:e[a],className:"chip-"+a})})):""})]}),Object(g.jsx)("div",{className:"player-score",children:Object(g.jsx)(f,{score:this.props.score,onChange:this.props.onScoreChange,isHost:this.props.isHost})})]})}}]),t}(a.Component),O=4,x=function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(e){var a;return Object(o.a)(this,t),(a=s.call(this,e)).componentDidMount=function(){a.interval=setInterval(a.onTick,100)},a.componentWillUnmount=function(){clearInterval(a.interval)},a.state={running:!1,elapsedTime:0,previousTime:0},a.onStart=a.onStart.bind(Object(p.a)(a)),a.onStop=a.onStop.bind(Object(p.a)(a)),a.onReset=a.onReset.bind(Object(p.a)(a)),a.onTick=a.onTick.bind(Object(p.a)(a)),a}return Object(c.a)(t,[{key:"onTick",value:function(){if(this.state.running){var e=Date.now();this.setState({previousTime:e,elapsedTime:this.state.elapsedTime+(e-this.state.previousTime)})}}},{key:"onStart",value:function(){this.state={running:!0,previousTime:Date.now()},this.setState(this.state)}},{key:"onStop",value:function(){this.state={running:!1},this.setState(this.state)}},{key:"onReset",value:function(){this.state={elapsedTime:0,previousTime:Date.now()},this.setState(this.state)}},{key:"render",value:function(){var e=Math.floor(this.state.elapsedTime/1e3),s=this.state.running?Object(g.jsx)("button",{onClick:this.onStop,children:"Stop"}):Object(g.jsx)("button",{onClick:this.onStart,children:"Start"});return Object(g.jsxs)("div",{className:"stopwatch",children:[Object(g.jsx)("h2",{children:"Stopwatch"}),Object(g.jsxs)("div",{className:"stopwatch-time",children:[" ",e," "]}),s,Object(g.jsx)("button",{onClick:this.onReset,children:"Reset"})]})}}]),t}(a.Component);a.Component;function k(e){var s=e.players.length,t=e.players.reduce((function(e,s){return e+s.score}),0);return Object(g.jsx)("table",{className:"stats",children:Object(g.jsxs)("tbody",{children:[Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:"Players:"}),Object(g.jsx)("td",{children:s})]}),Object(g.jsxs)("tr",{children:[Object(g.jsx)("td",{children:"Total Points:"}),Object(g.jsx)("td",{children:t})]})]})})}function C(e){return Object(g.jsxs)("div",{className:"header",children:[Object(g.jsx)(k,{players:e.players}),Object(g.jsx)("h1",{children:e.title}),Object(g.jsx)(x,{})]})}var N=function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(e){var a;return Object(o.a)(this,t),(a=s.call(this,e)).state={players:a.props.initialPlayers,messages:{}},a.onPlayerAdd=a.onPlayerAdd.bind(Object(p.a)(a)),a.onRemovePlayer=a.onRemovePlayer.bind(Object(p.a)(a)),a}return Object(c.a)(t,[{key:"componentDidUpdate",value:function(e){}},{key:"onScoreChange",value:function(e,s){this.props.initialPlayers[e].score+=s,this.setState(this.state),this.props.database.ref("username/"+this.props.initialPlayers[e].uid).update({score:this.props.initialPlayers[e].score})}},{key:"onPlayerAdd",value:function(e){console.log("Player added",e),this.props.initialPlayers.push({name:e,score:0,id:O}),this.setState(this.state),O+=1}},{key:"onRemovePlayer",value:function(e){this.props.initialPlayers.splice(e,1),this.setState(this.state)}},{key:"render",value:function(){var e=this.getLeaderIndices();return Object(g.jsxs)("div",{className:"scoreboard",children:[Object(g.jsx)(C,{title:this.props.title,players:this.props.initialPlayers}),Object(g.jsx)("div",{className:"players",children:this.props.initialPlayers.map(function(s,t){return Object(g.jsx)(y,{onScoreChange:function(e){this.onScoreChange(t,e)}.bind(this),onRemove:function(){this.onRemovePlayer(t)}.bind(this),name:s.name,score:s.score,messages:this.props.messages[s.uid],isHost:this.props.isHost,photoURL:s.photoUrl,isLeader:e.indexOf(t)>-1},s.id)}.bind(this))})]})}},{key:"getLeaderIndices",value:function(){var e=0;this.props.initialPlayers.forEach((function(s){s.score>e&&(e=s.score)}));var s=[];return 0==e?[]:(this.props.initialPlayers.forEach((function(t,a){t.score==e&&s.push(a)})),s)}}]),t}(a.Component),S=t(81),P=function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(e){var a;return Object(o.a)(this,t),(a=s.call(this,e)).database=m.a.database(),a.state={prevMessages:[],users:{},players:[],message:"",playerMessages:{},database:a.database},a.sendMessage=a.sendMessage.bind(Object(p.a)(a)),a.onMessageChange=a.onMessageChange.bind(Object(p.a)(a)),a}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return Object(g.jsxs)("div",{className:"View",children:[Object(g.jsx)(S.a,{className:"messaging-paper",elevation:3,children:Object(g.jsxs)("div",{className:"Messaging",children:[Object(g.jsxs)("div",{className:"first-row",children:[Object(g.jsx)(j.a,{variant:"outlined",color:"default",onClick:function(){return e.quickAnswer("\ud83e\udd2f")},children:"\ud83e\udd2f"}),Object(g.jsx)(j.a,{variant:"outlined",color:"secondary",onClick:function(){return e.quickAnswer("\ud83e\udd80")},children:"\ud83e\udd80"}),Object(g.jsx)(j.a,{variant:"outlined",color:"secondary",onClick:function(){return e.quickAnswer("\ud83d\udc96")},children:"\ud83d\udc96"})]}),Object(g.jsxs)("div",{className:"second-row",children:[Object(g.jsx)(j.a,{variant:"outlined",color:"secondary",onClick:function(){return e.quickAnswer("\ud83c\udf89")},children:"\ud83c\udf89"}),Object(g.jsx)(j.a,{variant:"outlined",color:"secondary",onClick:function(){return e.quickAnswer("\ud83d\udc4d")},children:"\ud83d\udc4d"})]}),Object(g.jsx)("div",{className:"custom-text-form",children:Object(g.jsxs)("form",{onSubmit:this.sendMessage,children:[Object(g.jsx)("input",{placeholder:"Type your answer",type:"text",value:this.state.message,onChange:this.onMessageChange}),Object(g.jsx)(j.a,{type:"submit",variant:"contained",color:"primary",children:"Enter"})]})})]})}),Object(g.jsxs)("div",{className:"History",children:[Object(g.jsx)(N,{initialPlayers:this.state.players,messages:this.state.playerMessages,database:this.state.database,isHost:this.props.isHost}),Object(g.jsx)("div",{hidden:!this.props.isHost,children:Object(g.jsx)(j.a,{variant:"contained",color:"secondary",onClick:function(){return e.removeAllUsers()},children:"Remove all users (refresh page after)"})})]})]})}},{key:"componentDidUpdate",value:function(e){e&&this.props.user.uid==e.user.uid||(console.log("props.user update"),this.updateUserName(),this.deleteOldMessages(),this.setupPlayerListeners())}},{key:"updateUserName",value:function(){this.database.ref("username/"+this.props.user.uid).update({username:this.props.user.displayName,photoUrl:this.props.user.photoURL})}},{key:"removeAllUsers",value:function(){this.database.ref("username").on("child_added",(function(e){e.ref.remove()}))}},{key:"deleteOldMessages",value:function(){var e=this.database.ref("users/"+this.props.user.uid),s=Date.now()-72e5;e.orderByChild("timestamp").endAt(s).limitToLast(1).on("child_added",(function(e){e.ref.remove()}))}},{key:"quickAnswer",value:function(e){this.state.message=e,this.sendMessage()}},{key:"sendMessage",value:function(e){if(e&&e.preventDefault(),this.state.message){var s=this.state.message;this.setState({message:""}),this.database.ref("users/"+this.props.user.uid).push().set({message:s,timestamp:Date.now()})}}},{key:"setupPlayerListeners",value:function(){var e=this,s=this.database.ref("username");s.on("child_added",(function(s){e.state.users[s.key]={username:s.val().username,score:s.val().score||0,photoUrl:s.val().photoUrl};var t=Object.keys(e.state.users).sort().map((function(s,t){return{name:e.state.users[s].username,id:t,score:e.state.users[s].score,uid:s,photoUrl:e.state.users[s].photoUrl}}));e.setState({players:t}),e.setupChatHistoryListeners(t)})),s.on("child_changed",(function(s){e.state.users[s.key]={username:s.val().username,score:s.val().score||0,photoUrl:s.val().photoUrl};var t=Object.keys(e.state.users).sort().map((function(s,t){return{name:e.state.users[s].username,id:t,score:e.state.users[s].score,uid:s,photoUrl:e.state.users[s].photoUrl}}));e.setState({players:t})}))}},{key:"setupChatHistoryListeners",value:function(e){var s,t=this,a=Object(h.a)(e);try{var i=function(){var e=s.value;t.database.ref("users/"+e.uid).orderByChild("timestamp").limitToLast(3).on("child_added",(function(s){console.log(s.val().message);var a=t.state.playerMessages[e.uid];a||(a=t.state.playerMessages[e.uid]={}),a.lastTimestamp&&a.lastTimestamp===s.val().timestamp||(a.lastTimestamp=s.val().timestamp,a.messages||(a.messages=[]),a.messages.unshift(s.val().message),a.messages.length>3&&a.messages.pop(),t.setState({playerMessages:t.state.playerMessages}))}))};for(a.s();!(s=a.n()).done;)i()}catch(n){a.e(n)}finally{a.f()}}},{key:"onMessageChange",value:function(e){this.setState({message:e.target.value})}}]),t}(a.Component),T=(t(59),function(e){Object(l.a)(t,e);var s=Object(d.a)(t);function t(e){var a;Object(o.a)(this,t),a=s.call(this,e),console.log("foo");return m.a.apps.length||m.a.initializeApp({apiKey:"AIzaSyB4X2zC7tYE6T5e0rIBlZ8RzbNhnAQ58Ws",authDomain:"multiplayer-trivia-68951.firebaseapp.com",projectId:"multiplayer-trivia-68951",storageBucket:"multiplayer-trivia-68951.appspot.com",messagingSenderId:"1016103210575",appId:"1:1016103210575:web:c997edfe327ca68893e43a",measurementId:"G-7JBQP4CF0Y"}),a.state={signed:!1,user:{},isHost:!1},a.authProvider=new m.a.auth.GoogleAuthProvider,a}return Object(c.a)(t,[{key:"render",value:function(){var e=this;return Object(g.jsxs)("div",{className:"App",children:[Object(g.jsxs)("header",{className:"App-header",children:[Object(g.jsx)("h1",{children:" ML Insights Trivia "}),Object(g.jsx)("img",{src:this.state.user.photoURL,className:"Google-photo",hidden:!this.state.signed}),Object(g.jsx)("img",{src:u,className:"App-logo",alt:"logo"})]}),Object(g.jsx)("div",{hidden:!this.state.signed,children:Object(g.jsx)(P,{hidden:!this.state.signed,user:this.state.user,isHost:this.state.isHost})}),Object(g.jsx)("div",{className:"Sign-in-button-div",children:Object(g.jsx)(j.a,{variant:"contained",color:"primary",disabled:this.state.signed,onClick:function(){return e.signIn()},children:"Sign in to Google"})})]})}},{key:"signIn",value:function(){var e=this;m.a.auth().signInWithPopup(this.authProvider).then((function(s){s.credential.accessToken;var t=s.user;e.setState({signed:!0,user:s.user,isHost:"93ev6xk0QzPQJG7daXFOD7YlzZi1"==s.user.uid||"CSGH2cs8wWY0dfIzO961RziMdgM2"==s.user.uid}),console.log(t.displayName)})).catch((function(e){e.code,e.message,e.email,e.credential}))}}]),t}(a.Component)),M=function(e){e&&e instanceof Function&&t.e(3).then(t.bind(null,84)).then((function(s){var t=s.getCLS,a=s.getFID,i=s.getFCP,n=s.getLCP,r=s.getTTFB;t(e),a(e),i(e),n(e),r(e)}))};r.a.render(Object(g.jsx)(i.a.StrictMode,{children:Object(g.jsx)(T,{})}),document.getElementById("root")),M()}},[[61,1,2]]]);
//# sourceMappingURL=main.746f7502.chunk.js.map